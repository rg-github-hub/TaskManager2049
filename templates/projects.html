{% extends "base.html" %}
{% set page = "Projects" %}
{% block content %}
{% if is_admin %}
<div style='padding-bottom: 25px;'>
<a href="/create_project" class = 'btn btn-info' >Create New Project</a>
 
</div>
{% endif %}


<div class="card">
    <div class="card-header">
      <h3 class="card-title">Projects</h3>
    </div>
    <!-- /.card-header -->
    <div class="card-body">
      <div id="jsGrid1"></div>
    </div>
    <!-- /.card-body -->
  </div>
{% endblock %}

{% block script %}
<script src="static/plugins/jsgrid/demos/db.js"></script>

<script src="static/plugins/jsgrid/jsgrid.min.js"></script>

<script src="static/dist/js/demo.js"></script>
<script>
    var clients = [
{% for i in project_list %}
{% if loop.index == 1 %}
{
  "Project Name": "{{i.name}}",
  "Project Id": {{i.id}},
}
{% else %}
    ,{
  "Project Name": "{{i.name}}",
  "Project Id": {{i.id}},
}
{% endif %}

{% endfor %}
];


    $(function () {
        $("#jsGrid1").jsGrid({
  width: "100%",
  //height: "100%",
  inserting: false,
  editing: false,
  sorting: true,
  paging: true,


  data: clients,
  selecting: true,
{% if is_admin %}
  onItemDeleted: function(args) {
    //console.log(args.item['Employee Id'])
    const Data = {"id" : args.item['Project Id']}
		const otherPram={
			headers:{
				"Content-Type":"application/json; charset=UTF-8"
			},
			body:JSON.stringify(Data),
			method:"POST"
		};
		fetch('/delete_project', otherPram).then(function(response){location.reload()});
                    
                },

{% endif %}

  fields: [{
    name: "Project Name",
    width: 100

  },{
    name: "Project Id",
    width: 40
  }
  {% if is_admin %}
  ,
  {
                name: "Remove",
                width:20,
                type: "control",
                modeSwitchButton: false,
                editButton: false,
                
                
  }
  {% endif %}
],
  rowClick: function(args) {
    console.log(args.item['Project Id'])
    window.location.href = "/projects/" + args.item['Project Id'];
  }
});
    });
  </script>
{% endblock %}