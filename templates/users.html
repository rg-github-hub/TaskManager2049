{% extends "base.html" %}

{% block content %}
<div style='padding-bottom: 25px;'>
<a href="/create_user" class = 'btn btn-info' >Create New User</a>
 
</div>


<div class="card">
    <div class="card-header">
      <h3 class="card-title">Users</h3>
    </div>
    <!-- /.card-header -->
    <div class="card-body">
      <div id="jsGrid1"></div>
    </div>
    <!-- /.card-body -->
  </div>
{% endblock %}

{% block script %}
<script src="static/plugins/jsgrid/demos/db.js"></script>

<script src="static/plugins/jsgrid/jsgrid.min.js"></script>

<script src="static/dist/js/demo.js"></script>
<script>
    var clients = [
{% for i in user_list %}
{% if loop.index == 1 %}
{
  "Name": "{{i.name}}",
  "Employee Id": {{i.id}},
}
{% else %}
    ,{
  "Name": "{{i.name}}",
  "Employee Id": {{i.id}},
}
{% endif %}

{% endfor %}
];
    $(function () {
        $("#jsGrid1").jsGrid({
  width: "100%",
  //height: "100%",
  inserting: false,
  editing: false,
  sorting: true,
  paging: true,


  data: clients,
  selecting: true,
  onItemDeleted: function(args) {
    //console.log(args.item['Employee Id'])
    const Data = {"id" : args.item['Employee Id']}
		const otherPram={
			headers:{
				"Content-Type":"application/json; charset=UTF-8"
			},
			body:JSON.stringify(Data),
			method:"POST"
		};
		fetch('/delete_user', otherPram).then(function(response){location.reload()});
                    
                },
  fields: [{
    name: "Name",
    width: 100

  },{
    name: "Employee Id",
    width: 40
  },
  {
                name: "Remove",
                width:20,
                type: "control",
                modeSwitchButton: false,
                editButton: false,
                
                
  }
],
  rowClick: function(args) {
    console.log(args.item['Employee Id'])
    window.location.href = "/users/" + args.item['Employee Id'];
  }
});
    });
  </script>
{% endblock %}